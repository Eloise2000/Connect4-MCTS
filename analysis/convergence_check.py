import matplotlib.pyplot as plt
from matplotlib.patches import Ellipse
''' 
Dataset from run 500 epochs training:
q_value_list: Q-value for the root node
is_stable_list: whether it is considered stable based on our algorithm
'''
action_last_time = [None, 0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 6, 6, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 0, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
q_value_0 = [float("-inf"), -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.6666666666666666, -0.25, 0.0, -0.16666666666666666, 0.0, 0.125, 0.0, 0.1, 0.18181818181818182, 0.08333333333333333, 0.15384615384615385, 0.14285714285714285, 0.06666666666666667, 0.125, 0.17647058823529413, 0.1111111111111111, 0.15789473684210525, 0.15, 0.14285714285714285, 0.09090909090909091, 0.09090909090909091, 0.09090909090909091, 0.09090909090909091, 0.13043478260869565, 0.08333333333333333, 0.08, 0.11538461538461539, 0.14814814814814814, 0.17857142857142858, 0.13793103448275862, 0.1, 0.1, 0.1, 0.12903225806451613, 0.15625, 0.12121212121212122, 0.11764705882352941, 0.14285714285714285, 0.1111111111111111, 0.1111111111111111, 0.13513513513513514, 0.15789473684210525, 0.15384615384615385, 0.175, 0.17073170731707318, 0.19047619047619047, 0.20930232558139536, 0.22727272727272727, 0.24444444444444444, 0.2608695652173913, 0.23404255319148937, 0.20833333333333334, 0.22448979591836735, 0.2, 0.21568627450980393, 0.19230769230769232, 0.18867924528301888, 0.2037037037037037, 0.21818181818181817, 0.21428571428571427, 0.22807017543859648, 0.2413793103448276, 0.2542372881355932, 0.25, 0.22950819672131148, 0.20967741935483872, 0.19047619047619047, 0.171875, 0.171875, 0.18461538461538463, 0.16666666666666666, 0.16417910447761194, 0.17647058823529413, 0.17391304347826086, 0.17142857142857143, 0.16901408450704225, 0.18055555555555555, 0.1780821917808219, 0.16216216216216217, 0.16216216216216217, 0.16216216216216217, 0.14666666666666667, 0.14666666666666667, 0.13157894736842105, 0.14285714285714285, 0.15384615384615385, 0.13924050632911392, 0.15, 0.14814814814814814, 0.13414634146341464, 0.14457831325301204, 0.15476190476190477, 0.16470588235294117, 0.1744186046511628, 0.1839080459770115, 0.17045454545454544, 0.1797752808988764, 0.18888888888888888, 0.18681318681318682, 0.17391304347826086, 0.16129032258064516, 0.1595744680851064, 0.15789473684210525, 0.16666666666666666, 0.16494845360824742, 0.17346938775510204, 0.16161616161616163, 0.15, 0.15, 0.13861386138613863, 0.14705882352941177, 0.1553398058252427, 0.14423076923076922, 0.1523809523809524, 0.1509433962264151, 0.14018691588785046, 0.14814814814814814, 0.14678899082568808, 0.15454545454545454, 0.15315315315315314, 0.16071428571428573, 0.168141592920354, 0.17543859649122806, 0.16521739130434782, 0.15517241379310345, 0.1623931623931624, 0.1694915254237288, 0.15966386554621848, 0.16666666666666666, 0.17355371900826447, 0.1721311475409836, 0.17886178861788618, 0.1774193548387097, 0.184, 0.1746031746031746, 0.18110236220472442, 0.1796875, 0.17829457364341086, 0.16923076923076924, 0.16793893129770993, 0.1590909090909091, 0.1590909090909091, 0.15789473684210525, 0.14925373134328357, 0.15555555555555556, 0.14705882352941177, 0.145985401459854, 0.13768115942028986, 0.1366906474820144, 0.12857142857142856, 0.12056737588652482, 0.12056737588652482, 0.1267605633802817, 0.13286713286713286, 0.13194444444444445, 0.1310344827586207, 0.136986301369863, 0.1292517006802721, 0.12162162162162163, 0.12751677852348994, 0.13333333333333333, 0.1390728476821192, 0.14473684210526316, 0.1503267973856209, 0.15584415584415584, 0.16129032258064516, 0.16025641025641027, 0.16560509554140126, 0.16455696202531644, 0.16352201257861634, 0.15625, 0.14906832298136646, 0.1419753086419753, 0.147239263803681, 0.1402439024390244, 0.14545454545454545, 0.15060240963855423, 0.1437125748502994, 0.14285714285714285, 0.14792899408284024, 0.15294117647058825, 0.15789473684210525, 0.1569767441860465, 0.16184971098265896, 0.16091954022988506, 0.16, 0.16477272727272727, 0.1694915254237288, 0.16853932584269662, 0.16201117318435754, 0.15555555555555556, 0.14917127071823205, 0.14835164835164835, 0.14754098360655737, 0.14130434782608695, 0.13513513513513514, 0.13978494623655913, 0.1443850267379679, 0.14893617021276595, 0.15343915343915343, 0.14736842105263157, 0.1518324607329843, 0.15104166666666666, 0.14507772020725387, 0.14432989690721648, 0.13846153846153847, 0.14285714285714285, 0.14720812182741116, 0.15151515151515152, 0.1507537688442211, 0.155, 0.14925373134328357, 0.15346534653465346, 0.1477832512315271, 0.15196078431372548, 0.15609756097560976, 0.16019417475728157, 0.1642512077294686, 0.15865384615384615, 0.15789473684210525, 0.15714285714285714, 0.16113744075829384, 0.15566037735849056, 0.15492957746478872, 0.14953271028037382, 0.14953271028037382, 0.14953271028037382, 0.14418604651162792, 0.14418604651162792, 0.14418604651162792, 0.14814814814814814, 0.15207373271889402, 0.15137614678899083, 0.1506849315068493, 0.14545454545454545, 0.1493212669683258, 0.15315315315315314, 0.15246636771300448, 0.14732142857142858, 0.14222222222222222, 0.13716814159292035, 0.14096916299559473, 0.13596491228070176, 0.13537117903930132, 0.13478260869565217, 0.13852813852813853, 0.14224137931034483, 0.1459227467811159, 0.14957264957264957, 0.14468085106382977, 0.13983050847457626, 0.14345991561181434, 0.14285714285714285, 0.14225941422594143, 0.14583333333333334, 0.14107883817427386, 0.13636363636363635, 0.13991769547325103, 0.14344262295081966, 0.1469387755102041, 0.14634146341463414, 0.14979757085020243, 0.14919354838709678, 0.14457831325301204, 0.14, 0.14342629482071714, 0.14285714285714285, 0.14624505928853754, 0.14566929133858267, 0.14901960784313725, 0.14453125, 0.14007782101167315, 0.13953488372093023, 0.14285714285714285, 0.13846153846153847, 0.13409961685823754, 0.13409961685823754, 0.1297709923664122, 0.13307984790874525, 0.13636363636363635, 0.13962264150943396, 0.13533834586466165, 0.13108614232209737, 0.13432835820895522, 0.13382899628252787, 0.13703703703703704, 0.14022140221402213, 0.13602941176470587, 0.13186813186813187, 0.13503649635036497, 0.13818181818181818, 0.14130434782608695, 0.1371841155234657, 0.13309352517985612, 0.13261648745519714, 0.12857142857142856, 0.12455516014234876, 0.1276595744680851, 0.12367491166077739, 0.1267605633802817, 0.12280701754385964, 0.1258741258741259, 0.1289198606271777, 0.13194444444444445, 0.12802768166089964, 0.1310344827586207, 0.13058419243986255, 0.13356164383561644, 0.1296928327645051, 0.1292517006802721, 0.13220338983050847, 0.13175675675675674, 0.13131313131313133, 0.12751677852348994, 0.13043478260869565, 0.13333333333333333, 0.1362126245847176, 0.13245033112582782, 0.1353135313531353, 0.13815789473684212, 0.13442622950819672, 0.13725490196078433, 0.13680781758957655, 0.13636363636363635, 0.13915857605177995, 0.14193548387096774, 0.1382636655948553, 0.14102564102564102, 0.14376996805111822, 0.1464968152866242, 0.14603174603174604, 0.14873417721518986, 0.15141955835962145, 0.1540880503144654, 0.1536050156739812, 0.153125, 0.1526479750778816, 0.14906832298136646, 0.14860681114551083, 0.15123456790123457, 0.15076923076923077, 0.15337423312883436, 0.14984709480122324, 0.14634146341463414, 0.14893617021276595, 0.14545454545454545, 0.14501510574018128, 0.14156626506024098, 0.14114114114114115, 0.1377245508982036, 0.1377245508982036, 0.14029850746268657, 0.13690476190476192, 0.13353115727002968, 0.1301775147928994, 0.13274336283185842, 0.13529411764705881, 0.1378299120234604, 0.14035087719298245, 0.14285714285714285, 0.14244186046511628, 0.14492753623188406, 0.14739884393063585, 0.1440922190201729, 0.14367816091954022, 0.14326647564469913, 0.1457142857142857, 0.14814814814814814, 0.14772727272727273, 0.14447592067988668, 0.14124293785310735, 0.14366197183098592, 0.14606741573033707, 0.1484593837535014, 0.14804469273743018, 0.14484679665738162, 0.14444444444444443, 0.14681440443213298, 0.14917127071823205, 0.14600550964187328, 0.14285714285714285, 0.14246575342465753, 0.1448087431693989, 0.1444141689373297, 0.14673913043478262, 0.14634146341463414, 0.14324324324324325, 0.14555256064690028, 0.1478494623655914, 0.15013404825737264, 0.15240641711229946, 0.14933333333333335, 0.15159574468085107, 0.14854111405835543, 0.14814814814814814, 0.1503957783641161, 0.14736842105263157, 0.14960629921259844, 0.14659685863874344, 0.14882506527415143, 0.15104166666666666, 0.15064935064935064, 0.14766839378238342, 0.14728682170542637, 0.14690721649484537, 0.14652956298200515, 0.14358974358974358, 0.1432225063938619, 0.14285714285714285, 0.14249363867684478, 0.1446700507614213, 0.1468354430379747, 0.14393939393939395, 0.14609571788413098, 0.14321608040201006, 0.14285714285714285, 0.14, 0.1371571072319202, 0.13930348258706468, 0.13647642679900746, 0.13613861386138615, 0.1382716049382716, 0.14039408866995073, 0.14004914004914004, 0.14215686274509803, 0.14425427872860636, 0.14390243902439023, 0.1435523114355231, 0.1407766990291262, 0.13801452784503632, 0.13526570048309178, 0.13734939759036144, 0.13942307692307693, 0.1366906474820144, 0.1339712918660287, 0.1339712918660287, 0.13126491646778043, 0.13333333333333333, 0.13539192399049882, 0.13744075829383887, 0.1347517730496454, 0.13679245283018868, 0.1388235294117647, 0.13615023474178403, 0.13817330210772832, 0.14018691588785046, 0.13986013986013987, 0.14186046511627906, 0.14385150812064965, 0.14583333333333334, 0.14318706697459585, 0.14285714285714285, 0.14022988505747128, 0.13761467889908258, 0.13729977116704806, 0.13926940639269406, 0.13895216400911162, 0.1409090909090909, 0.14285714285714285, 0.14027149321266968, 0.14221218961625282, 0.13963963963963963, 0.14157303370786517, 0.13901345291479822, 0.13870246085011187, 0.140625, 0.13808463251670378, 0.14, 0.13747228381374724, 0.13938053097345132, 0.141280353200883, 0.13876651982378854, 0.14065934065934066, 0.14035087719298245, 0.1422319474835886, 0.13973799126637554, 0.14161220043572983, 0.14347826086956522, 0.14533622559652928, 0.1471861471861472, 0.1490280777537797, 0.14655172413793102, 0.14408602150537633]
q_value_6 = [float("-inf"), float("-inf"), 1.0, 1.0, 1.0, 1.0, 0.6, 0.6666666666666666, 0.7142857142857143, 0.5, 0.3333333333333333, 0.3333333333333333, 0.4, 0.2727272727272727, 0.16666666666666666, 0.07692307692307693, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06666666666666667, 0.0, -0.058823529411764705, -0.058823529411764705, -0.058823529411764705, -0.058823529411764705, -0.058823529411764705, -0.058823529411764705, -0.058823529411764705, -0.058823529411764705, -0.058823529411764705, 0.0, -0.05263157894736842, -0.05263157894736842, -0.05263157894736842, -0.05263157894736842, -0.05263157894736842, -0.05263157894736842, -0.05263157894736842, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.14285714285714285, -0.09090909090909091, -0.13043478260869565, -0.13043478260869565, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.16666666666666666, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.2, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.23076923076923078, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.25925925925925924, -0.21428571428571427, -0.2413793103448276, -0.2413793103448276, -0.23333333333333334, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.25806451612903225, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.28125, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.30303030303030304, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059, -0.3235294117647059]
is_stable_list = [False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True]
q_value_list = [-1.0, 0.0, 0.3333333333333333, 0.5, 0.6, 0.3333333333333333, 0.42857142857142855, 0.5, 0.3333333333333333, 0.2, 0.09090909090909091, 0.16666666666666666, 0.07692307692307693, 0.0, -0.06666666666666667, -0.125, -0.11764705882352941, -0.05555555555555555, 0.0, -0.05, 0.0, 0.045454545454545456, 0.0, 0.041666666666666664, 0.08, 0.038461538461538464, 0.07407407407407407, 0.07142857142857142, 0.034482758620689655, 0.06666666666666667, 0.0967741935483871, 0.0625, 0.09090909090909091, 0.08823529411764706, 0.08571428571428572, 0.05555555555555555, 0.08108108108108109, 0.05263157894736842, 0.02564102564102564, 0.05, 0.024390243902439025, 0.023809523809523808, 0.046511627906976744, 0.06818181818181818, 0.08888888888888889, 0.06521739130434782, 0.0425531914893617, 0.0625, 0.04081632653061224, 0.06, 0.0784313725490196, 0.057692307692307696, 0.05660377358490566, 0.07407407407407407, 0.05454545454545454, 0.03571428571428571, 0.05263157894736842, 0.06896551724137931, 0.06779661016949153, 0.08333333333333333, 0.08196721311475409, 0.0967741935483871, 0.1111111111111111, 0.125, 0.13846153846153847, 0.15151515151515152, 0.13432835820895522, 0.11764705882352941, 0.13043478260869565, 0.11428571428571428, 0.1267605633802817, 0.1111111111111111, 0.1095890410958904, 0.12162162162162163, 0.13333333333333333, 0.13157894736842105, 0.14285714285714285, 0.15384615384615385, 0.16455696202531644, 0.1625, 0.14814814814814814, 0.13414634146341464, 0.12048192771084337, 0.10714285714285714, 0.09411764705882353, 0.10465116279069768, 0.09195402298850575, 0.09090909090909091, 0.10112359550561797, 0.1, 0.0989010989010989, 0.09782608695652174, 0.10752688172043011, 0.10638297872340426, 0.09473684210526316, 0.10416666666666667, 0.09278350515463918, 0.08163265306122448, 0.0707070707070707, 0.06, 0.06930693069306931, 0.0784313725490196, 0.06796116504854369, 0.07692307692307693, 0.0761904761904762, 0.0660377358490566, 0.07476635514018691, 0.08333333333333333, 0.09174311926605505, 0.1, 0.10810810810810811, 0.09821428571428571, 0.10619469026548672, 0.11403508771929824, 0.11304347826086956, 0.10344827586206896, 0.09401709401709402, 0.09322033898305085, 0.09243697478991597, 0.1, 0.09917355371900827, 0.10655737704918032, 0.0975609756097561, 0.08870967741935484, 0.08, 0.07142857142857142, 0.07874015748031496, 0.0859375, 0.07751937984496124, 0.08461538461538462, 0.08396946564885496, 0.07575757575757576, 0.08270676691729323, 0.08208955223880597, 0.08888888888888889, 0.08823529411764706, 0.0948905109489051, 0.10144927536231885, 0.1079136690647482, 0.1, 0.09219858156028368, 0.09859154929577464, 0.1048951048951049, 0.09722222222222222, 0.10344827586206896, 0.1095890410958904, 0.10884353741496598, 0.11486486486486487, 0.11409395973154363, 0.12, 0.11258278145695365, 0.11842105263157894, 0.11764705882352941, 0.11688311688311688, 0.10967741935483871, 0.10897435897435898, 0.10191082802547771, 0.0949367088607595, 0.09433962264150944, 0.0875, 0.09316770186335403, 0.08641975308641975, 0.08588957055214724, 0.07926829268292683, 0.07878787878787878, 0.07228915662650602, 0.0658682634730539, 0.05952380952380952, 0.0650887573964497, 0.07058823529411765, 0.07017543859649122, 0.06976744186046512, 0.07514450867052024, 0.06896551724137931, 0.06285714285714286, 0.06818181818181818, 0.07344632768361582, 0.07865168539325842, 0.08379888268156424, 0.08888888888888889, 0.09392265193370165, 0.0989010989010989, 0.09836065573770492, 0.10326086956521739, 0.10270270270270271, 0.10215053763440861, 0.0962566844919786, 0.09042553191489362, 0.08465608465608465, 0.08947368421052632, 0.08376963350785341, 0.08854166666666667, 0.09326424870466321, 0.08762886597938144, 0.08717948717948718, 0.09183673469387756, 0.09644670050761421, 0.10101010101010101, 0.10050251256281408, 0.105, 0.1044776119402985, 0.10396039603960396, 0.10837438423645321, 0.11274509803921569, 0.11219512195121951, 0.10679611650485436, 0.10144927536231885, 0.09615384615384616, 0.09569377990430622, 0.09523809523809523, 0.09004739336492891, 0.08490566037735849, 0.0892018779342723, 0.09345794392523364, 0.09767441860465116, 0.10185185185185185, 0.0967741935483871, 0.10091743119266056, 0.1004566210045662, 0.09545454545454546, 0.09502262443438914, 0.09009009009009009, 0.09417040358744394, 0.09821428571428571, 0.10222222222222223, 0.10176991150442478, 0.10572687224669604, 0.10087719298245613, 0.10480349344978165, 0.1, 0.1038961038961039, 0.10775862068965517, 0.11158798283261803, 0.11538461538461539, 0.11063829787234042, 0.11016949152542373, 0.10970464135021098, 0.1134453781512605, 0.1087866108786611, 0.10833333333333334, 0.1037344398340249, 0.10743801652892562, 0.102880658436214, 0.09836065573770492, 0.09795918367346938, 0.09349593495934959, 0.09716599190283401, 0.10080645161290322, 0.10040160642570281, 0.1, 0.09561752988047809, 0.0992063492063492, 0.10276679841897234, 0.10236220472440945, 0.09803921568627451, 0.09375, 0.08949416342412451, 0.09302325581395349, 0.0888030888030888, 0.08846153846153847, 0.08812260536398467, 0.0916030534351145, 0.09505703422053231, 0.09848484848484848, 0.1018867924528302, 0.09774436090225563, 0.09363295880149813, 0.09701492537313433, 0.09665427509293681, 0.0962962962962963, 0.0996309963099631, 0.09558823529411764, 0.09157509157509157, 0.0948905109489051, 0.09818181818181818, 0.10144927536231885, 0.10108303249097472, 0.10431654676258993, 0.1039426523297491, 0.1, 0.09608540925266904, 0.09929078014184398, 0.0989399293286219, 0.10211267605633803, 0.10175438596491228, 0.1048951048951049, 0.10104529616724739, 0.09722222222222222, 0.09688581314878893, 0.1, 0.09621993127147767, 0.09246575342465753, 0.08873720136518772, 0.08503401360544217, 0.08813559322033898, 0.09121621621621621, 0.09427609427609428, 0.09060402684563758, 0.08695652173913043, 0.09, 0.08970099667774087, 0.09271523178807947, 0.09570957095709572, 0.09210526315789473, 0.08852459016393442, 0.0915032679738562, 0.09446254071661238, 0.09740259740259741, 0.09385113268608414, 0.09032258064516129, 0.09003215434083602, 0.08653846153846154, 0.08306709265175719, 0.08598726114649681, 0.08253968253968254, 0.08544303797468354, 0.08201892744479496, 0.08490566037735849, 0.0877742946708464, 0.090625, 0.08722741433021806, 0.09006211180124224, 0.08978328173374613, 0.09259259259259259, 0.08923076923076922, 0.08895705521472393, 0.09174311926605505, 0.09146341463414634, 0.0911854103343465, 0.08787878787878788, 0.09063444108761329, 0.09337349397590361, 0.0960960960960961, 0.09281437125748503, 0.0955223880597015, 0.09821428571428571, 0.09495548961424333, 0.09763313609467456, 0.09734513274336283, 0.09705882352941177, 0.09970674486803519, 0.1023391812865497, 0.09912536443148688, 0.10174418604651163, 0.10434782608695652, 0.1069364161849711, 0.10662824207492795, 0.10919540229885058, 0.11174785100286533, 0.11428571428571428, 0.11396011396011396, 0.11363636363636363, 0.11331444759206799, 0.11016949152542373, 0.10985915492957747, 0.11235955056179775, 0.11204481792717087, 0.11452513966480447, 0.11142061281337047, 0.10833333333333334, 0.11080332409972299, 0.10773480662983426, 0.10743801652892562, 0.1043956043956044, 0.10410958904109589, 0.10109289617486339, 0.09809264305177112, 0.10054347826086957, 0.0975609756097561, 0.0945945945945946, 0.09164420485175202, 0.09408602150537634, 0.09651474530831099, 0.09893048128342247, 0.10133333333333333, 0.10372340425531915, 0.10344827586206896, 0.10582010582010581, 0.10817941952506596, 0.10526315789473684, 0.10498687664041995, 0.10471204188481675, 0.10704960835509138, 0.109375, 0.10909090909090909, 0.10621761658031088, 0.10335917312661498, 0.1056701030927835, 0.10796915167095116, 0.11025641025641025, 0.10997442455242967, 0.10714285714285714, 0.10687022900763359, 0.10913705583756345, 0.11139240506329114, 0.10858585858585859, 0.10579345088161209, 0.10552763819095477, 0.10776942355889724, 0.1075, 0.10972568578553615, 0.10945273631840796, 0.10669975186104218, 0.10891089108910891, 0.1111111111111111, 0.11330049261083744, 0.11547911547911548, 0.11274509803921569, 0.11491442542787286, 0.11219512195121951, 0.11192214111922141, 0.11407766990291263, 0.11138014527845036, 0.11352657004830918, 0.1108433734939759, 0.11298076923076923, 0.11510791366906475, 0.11483253588516747, 0.11217183770883055, 0.11190476190476191, 0.11163895486935867, 0.11137440758293839, 0.10874704491725769, 0.10849056603773585, 0.10823529411764705, 0.107981220657277, 0.11007025761124122, 0.11214953271028037, 0.10955710955710955, 0.11162790697674418, 0.10904872389791183, 0.1087962962962963, 0.10623556581986143, 0.10368663594470046, 0.10574712643678161, 0.10321100917431193, 0.10297482837528604, 0.1050228310502283, 0.1070615034168565, 0.10681818181818181, 0.10884353741496598, 0.11085972850678733, 0.11060948081264109, 0.11036036036036036, 0.10786516853932585, 0.10538116591928251, 0.1029082774049217, 0.10491071428571429, 0.10690423162583519, 0.10444444444444445, 0.10199556541019955, 0.09955752212389381, 0.09713024282560706, 0.09911894273127753, 0.1010989010989011, 0.10307017543859649, 0.10065645514223195, 0.10262008733624454, 0.10457516339869281, 0.10217391304347827, 0.10412147505422993, 0.10606060606060606, 0.10583153347732181, 0.10775862068965517, 0.10967741935483871, 0.11158798283261803, 0.10920770877944326, 0.10897435897435898, 0.10660980810234541, 0.10425531914893617, 0.1040339702760085, 0.1059322033898305, 0.10570824524312897, 0.10759493670886076, 0.10947368421052632, 0.10714285714285714, 0.1090146750524109, 0.10669456066945607, 0.10855949895615867, 0.10625, 0.10602910602910603, 0.1078838174273859, 0.10559006211180125, 0.10743801652892562, 0.10515463917525773, 0.10699588477366255, 0.10882956878850103, 0.10655737704918032, 0.1083844580777096, 0.10816326530612246, 0.109979633401222, 0.10772357723577236, 0.10953346855983773, 0.11133603238866396, 0.11313131313131314, 0.11491935483870967, 0.11670020120724346, 0.1144578313253012, 0.11222444889779559, 0.114]

''' Process the data and pick up the fisrt 400 data points '''
action_select = action_last_time[5:405]
q_action0 = q_value_0[4:404]
q_action6 = q_value_6[4:404]
is_stable = is_stable_list[4:404]
q_value_root = q_value_list[4:404]
epoch = list(range(1, 401))

convergence_index = is_stable_list.index(True)
highlight_x = epoch[convergence_index]
highlight_y = q_value_root[convergence_index]

print("The first True epoch is: ", convergence_index)

''' Plotting for Q-value of root node '''
# fig, ax = plt.subplots(figsize=(10, 6))

# ax.plot(epoch, q_value_root, label='Q-value for root node', marker='o', color="coral", markersize=2)

# # Highlight a specific point
# ax.scatter(epoch[convergence_index], q_value_root[convergence_index], color='green', marker='*', s=200, zorder=10)

# el = Ellipse((2, -1), 0.5, 0.5)
# ax.annotate('Termination\nPoint',
#             xy=(highlight_x, highlight_y), xycoords='data',
#             xytext=(-100, 60), textcoords='offset points',
#             size=15,
#             arrowprops=dict(arrowstyle="fancy",
#                             fc="0.6", ec="none",
#                             patchB=el,
#                             connectionstyle="angle3,angleA=0,angleB=-90"))

# ax.plot([highlight_x, highlight_x], [-0.17, highlight_y], color='gray', linestyle='--', linewidth=1)
# ax.plot([0, highlight_x], [highlight_y, highlight_y], color='gray', linestyle='--', linewidth=1)

# ax.set(xlim=(0, 400), ylim=(-0.17, 0.65))

# # Customize the plot
# plt.title('Q-value of Root Node Over Time')
# plt.xlabel('Epoch')
# plt.ylabel('Q-value')
# plt.legend()
# plt.grid(True)
# plt.show()

''' Plotting of Q-value for different actions of root node '''
fig, ax = plt.subplots(figsize=(10, 6))

# Plot the scores for each action
plt.plot(epoch, q_action0, label='Action column 0', marker='o', color="turquoise", markersize=2)
plt.plot(epoch, q_action6, label='Action column 6', marker='s', color="violet", markersize=2)

el = Ellipse((2, -1), 0.5, 0.5)
ax.annotate('Termination\nPoint',
            xy=(highlight_x, highlight_y + 0.1), xycoords='data',
            xytext=(-100, 60), textcoords='offset points',
            size=15,
            arrowprops=dict(arrowstyle="fancy",
                            fc="0.6", ec="none",
                            patchB=el,
                            connectionstyle="angle3,angleA=0,angleB=-90"))

plt.axvline(x=highlight_x, color='green', linestyle='--', linewidth=1, label='Termination epoch')

# ax.set(xlim=(0, 400), ylim=(-0.17, 0.65))

# Customize the plot
plt.title('Q-value of Root Node for Different Actions Over Time')
plt.xlabel('Epoch')
plt.ylabel('Q-value')
plt.legend()
plt.grid(True)
plt.show()